ccflags-y := -DDEBUG

obj-m += usbip-core.o
usbip-core-y := usbip_common.o usbip_event.o

obj-m += vhci-hcd.o
vhci-hcd-y := vhci_sysfs.o vhci_tx.o vhci_rx.o vhci_hcd.o

obj-m += usbip-host.o
usbip-host-y := stub_dev.o stub_main.o stub_rx.o stub_tx.o

obj-m += usbip-vudc.o
usbip-vudc-y := vudc_dev.o vudc_sysfs.o vudc_tx.o vudc_rx.o vudc_transfer.o vudc_main.o

KERNEL_VERSION = $(shell uname -r)
all:
	make -C /lib/modules/$(KERNEL_VERSION)/build M=$(shell pwd) modules

clean:
	make -C /lib/modules/$(KERNEL_VERSION)/build M=$(shell pwd) clean
